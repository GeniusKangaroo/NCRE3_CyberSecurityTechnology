## 第五章 应用安全

### 5.1软件漏洞

#### 5.1.1软件漏洞的概念和特点

- 概念：
  - 缺陷
- 产生原因：
  - 软件设计开发运行阶段的疏漏
  - 软件技术和代码规模的快速发展：代码规模的增加，漏洞的数量增加，模板化的原因使漏洞增加
  - 软件安全测试技术的滞后
- 特点
  - 危害大
  - 影响广泛
  - 存在的长久性
  - 隐蔽性



#### 5.1.2软件漏洞的分类

- 分类
  - 利用地点：
    - 本地利用
    - 远程利用
  - 形成原因
    - 输入验证错误
    - 缓冲区溢出：破环正常堆栈
    - 设计错误
    - 意外情况处置错误
    - 访问验证错误：逻辑错误
    - 配置错误漏洞
    - 竞争条件：文件进程处理出现了时序的问题
    - 环境错误：环境变量错误，恶意设置
    - 外部数据被异常执行漏洞：SQL注入，xss
  - 生命周期
    - 0day
    - 1day
    - 已公开漏洞
  - 直接威胁
    - 普通用户访问权限漏洞
    - 本地管理员权限漏洞
    - 远程管理员权限漏洞
    - 权限提升漏洞
    - 本地拒绝服务漏洞
    - 远程拒绝服务漏洞
    - 服务器信息泄露漏洞
    - 远程非授权文件存取漏洞
    - 读取受限文件漏洞
- 漏洞危险等级的划分
  - 紧急
  - 重要
  - 中危
  - 低危



#### 5.1.3漏洞库

- CVE
- BugTraq
- NVD
- CNNVD
- CNVD



#### *5.1.4常见软件漏洞<u>unchecked</u>*

- 缓冲区溢出漏洞<u>（unchecked）</u>
- 格式化字符串漏洞
- 整数溢出漏洞
- 数组越界漏洞
- 写污点值的到污点地址的漏洞
- 内存地址对象破环性调用漏洞



#### 5.1.5软件漏洞及其防护技术

- 漏洞利用的概念和shellcode的编写
  - 调试了解缓冲区的漏洞
  - 构造相应的参数并写出shellcode代码
  - shellcode：机器指令，执行指定的攻击操作
- 漏洞利用技术
  - 静态shellcode地址利用技术
    - os重启需要加载程序，内存地址是固定的，将shellcode存入指定的地址
  - 动态shellcode地址利用技术
    - 覆盖os返回的地址
    - 重新写入内存地址自动定位到shellcode
  - heap spray技术
    - 无法定位内存地址
    - 生成特殊的HTML文件，诱导触发事件
    - 主要用于浏览器漏洞的攻击
- 防护技术
  - GS Stack protection：缓冲区溢出的检测防护技术
  - DEP：数据执行保护，设置内存堆栈区的代码为不可执行状态
  - ASLR：空间地址分布随机化，将系统关键地址随机化
  - SafeSEH：Windows异常处理机制所采用的重要数据链表，异常数据可以存放于SEH
  - SEHOP：结构化异常处理覆盖保护，检测程序栈中所有的SEH结构链表的完整性

#### 5.1.6软件漏洞的发展趋势

- web威胁逐渐增加
- 成熟商业软件的漏洞利用难度增加
- 定制型软件的应用系统的漏洞增加
- 对已知漏洞利用依然存在
- 新兴计算机应用的漏洞攻击将成为重点



### 5.2软件开发

#### 5.2.1软件开发的生命周期

- 生命周期：

  - 问题的定义与划分

  - 需求分析

  - 软件设计

  - 程序编码

  - 软件测试

  - 运行维护

- 模型：

  - 瀑布模型
    - 需求—>分析—>设计—>编码—>测试
  - 螺旋模型
    - 需求—>架构—>设计—>编码—>开发—>测试
  - 迭代模型
    - 需求—>设计—>开发
  - 快速原型模型

#### 5.2.2软件安全开发

- 建立安全威胁模型
- 安全设计：
  - 最小权限原则
  - 开放设计原则
  - 全面防御原则
  - 权限分开原则
  - 最少公用原则
  - 心里接受性
  - 软件运行环境的考虑
  - 安全的加密算法
  - 考虑不安全的条件
  - 失效防护：后备防御措施
- 安全编程
  - 数据的机密性
  - 数据的完整性
  - 数据的有效性
- 安全测试
  - 制造畸形数据包做测试
  - 对用户输入进行全面检查
  - 验证输入输出文件
  - 测试非正常的路径及其路径限制
  - 全面测试异常处理
  - 采用非反汇编方式检测敏感信息

#### 5.2.3软件安全开发生命周期

- 第0阶段：准备阶段

- 第1阶段：项目启动阶段

- 第2阶段：定义需要遵守的安全设计原则

- 第3阶段：产品风险评估

- 第4阶段：风险分析

- 第5阶段：创建安全文档、安全配置工具

- 第6阶段：安全编码策略

- 第7阶段：安全测试策略

- 第8阶段：开发团队自身进行的全面安全分析检测

- 第9阶段：最终安全评审

- 第10阶段：组建安全响应团队制定安全响应计划

- 第11阶段：发布产品

- 第12阶段：安全响应执行

### 5.3软件安全检测

#### 5.3.1软件静态安全检测技术

- 软件源码的静态安全检测技术
  - 词法分析
  - 数据流分析
  - 污点传播分析：分析输入数据对程序执行路径的影响，以发现不可信的输入数据导致程序执行异常 
  - 符号执行
  - 模型检验
  - 定理证明
- 可执行代码的静态安全检测技术
  - 基于程序结构
  - 基于程序语义

#### 5.3.2动态软件安全检测技术

- 模糊测试
  - 确定测试对象和输入数据
  - 生成模糊测试数据
  - 检测模糊测试数据
  - 监测程序异常
  - 确定可利用性
- 智能模糊测试
  - 反汇编
  - 中间语言转换
  - 只能数据分析和执行路径关系
  - 分析获得的输入数据集合，对执行路径合集进行测试
- 动态污点分析
  - 分析被测试程序内部执行指令真实的执行过程



#### 5.3.3软件动静结合安全检测技术



### 5.4软件安全保护

#### 5.4.1软件安全保护的基本概念

- 概念
- 意义
- 法律

#### 5.4.2基于软件技术的软件安全保护技术

- 注册信息验证技术
- 软件防篡改技术
- 代码混淆技术
  - 词法转换
  - 控制流转换:执行顺序
  - 数据转换
- 软件水印技术
  - 产品版权保护技术
- 软件加壳技术
  - 实现对可执行文件的压缩或加密
- 反调试反跟踪技术

#### 5.4.3基于硬件介质的软件安全保护技术

- 加密狗
- 加密光盘
- 专用接口



### 5.5 恶意程序

#### 5.5.1恶意程序的分类
