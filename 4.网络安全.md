## 第四章 网络安全

### 4.1网络安全基础

#### 4.1.1 TCP/IP 协议架构

- TCP/IP开放模型
  - 物理和数据链路层
  - 网络层
  - 传输层
  - 应用层
- OSI/RM模型
  - 应用层
  - 表示层
  - 会话层
  - 传输层
  - 网络层
  - 数据链路层
  - 物理层

#### 4.1.2网络协议

- 数据链路层协议

  - ARP协议（地址解析）
    - 通过ip识别数据包发送的源主机和目的主机
    - MAC地址+数据帧
    - 实现ip地址与主机的MAC地址转换
    - ip与MAC之间的映射
    - 地址解析是在一个物理网络内的
  - RARP协议
    - 逆向地址转换协议
    - MAC转为ip

- 网络层协议

  - IP协议：实现跨越不同网络之间的主机通信

    - IP地址：32位的二进制IP地址，每8个一组转化为十进制数

      ​               前半部分为网络号，后半部分为主机号

    - IP地址分类：

      |          类别           |            IP             | 开头 | 网络号长度 | 主机号长度 |  含有主机个数  |
      | :---------------------: | :-----------------------: | :--: | :--------: | :--------: | :------------: |
      |            A            |  0.0.0.0~127.255.255.255  |  0   |     7      |     24     |  2的24次方-2   |
      | B（2的14次方个B类网络） | 128.0.0.0~191.255.255.255 |  10  |     14     |     16     |  2的16次方-2   |
      | C（2的21次方个C类网络） | 192.0.0.0~233.255.255.255 | 110  |     21     |     8      | 2的8次方-2/254 |
      |            D            | 234.0.0.0~239.255.255.255 | 1110 |     /      |     /      |       /        |
      |            E            | 240.0.0.0~255.255.255.255 | 1111 |     /      |     /      |       /        |

    - 其他IP地址：

      对于内网的网络设定，私有IP地址

      1. A类：10.0.0.0~10.255.255.255
      2. B类：172.16.0.0~172.31.255.255
      3. C类：192.168.0.0~192.168.255.255

    - IP数据包格式
    
    <img src="https://raw.githubusercontent.com/GeniusKangaroo/NCRE3_CyberSecurityTechnology/main/e56b9113abd9c2fe9ce83ff0c814734.jpg" style="zoom: 25%;" />
    
    
    
  - ICMP协议
  
    - 网络异常状态的监听和检测
    - TCP/IP网络中发送出错和控制消息
    - 错误侦测和反馈机制
  
- 传输层协议

  - TCP协议：

    - 头部格式：
      - tcp数据包由头部和数据两部分组成
      - 头部前20字节是固定的后面均可变
    - 三次握手：
      1. 源主机—>目标主机发送ACK为1的应答包，数据包中设置了源和目标的IP和port；SEQ=X
      2. 目标主机自动应答，返回数据包，表示同意建立链接；ACK=1，SYN=1，SEQ=Y，确认号=X+1
      3. 源主机—>目标主机发送ACK为1的应答包，确认建立链接；SEQ=X，确认号=Y+1

  - UDP协议：

    - 无连接的传输协议

- 应用层协议

  - HTTP：
    - 超文本传输协议
    - port：80
    - 先建立TCP连接
    - GET/POST提交数据
  - SMTP&POP3：
    - 简单邮件传输协议
    - port：25
    - 基于TCP协议
    - pop3是应用最广泛的邮件访问协议
  
- DNS：域名解析



### 4.2网络安全威胁技术

#### 4.2.1扫描技术

- 互联网信息收集

- IP地址扫描

- 网络端口扫描

  TCP和UDP端口号在0~65535范围之间

  1024一下保留给常用网络服务

  21：FTP

  23：Telnet

  25：SMTP

  80：HTTP

  110：POP3

  - TCP全连接扫描
  - TCP SYN 扫描：TCP的半连接扫描，前两次握手
  - TCP FIN 扫描：Unix为主
  - UDP的ICMP端口不可达扫描：UDP网络端口发送探测的数据包
  - ICMP扫描
  - 乱序扫描和慢速扫描：nmap

- 漏洞扫描

  基于获得IP，port后

  - 网络漏洞扫描
  - 主机漏洞扫描

- 弱口令扫描

  - 基于字典攻击
  - 基于穷举爆破

- 综合漏洞扫描

  Nessus

- 扫描的防范技术

#### 4.2.2网络嗅探

- 网络嗅探的原理
  - 端口监听
- 网络嗅探的防范
  - VPN，SSL，SSH加密传输技术
  - 交换机的VLAN功能

#### 4.2.3网络协议的欺骗

- IP地址欺骗

  伪造IP向目标主机发送数据包

- ARP欺骗

  - ARP协议：IP到MAC地址的交换
  - 若曾经有数据通信，ARP缓存表会更新
  - 攻击者伪装成恶意主机，发送欺骗的ARP数据包，使其更新ARP缓存表，建立错误的IP与MAC的对应关系
  - 分类：
    - 中间人欺骗
    - 伪装成网关欺骗

- TCP欺骗

  - 将外部计算机伪装成合法的计算机，使其允许对数据进行修改
  - 非盲攻击：网络嗅探获得主机的数据包
  - 盲攻击：无法获得主机的初始化序列号



#### 4.2.4诱骗式攻击

- 网站挂马
- 诱骗下载
- 钓鱼网站
- 社会工程学

#### 4.2.5软件漏洞攻击利用技术

- 软件漏洞的概念与分类
  - 操作系统服务程序漏洞
  - 文件处理软件漏洞
  - 浏览器软件漏洞
- 软件漏洞的攻击利用技术
  - 直接网络攻击
  - 诱骗式网络技术
    - 基于网站的诱骗式间接网络攻击
    - 网络传播本地诱骗点击攻击
- 软件漏洞攻击的防范
  - 安装使用新版本的操作系统和软件
  - 。。。。。。



#### 4.2.6拒绝服务攻击

- DoS攻击

  连接请求超过目标主机的最大连接上限，无额外资源对外提供服务

  - 实现方式：
    - 利用目标主机本身存在拒绝服务型漏洞进行攻击
    - 耗尽主机CPU和内存
    - 耗尽主机网络带宽
  - 攻击分类：
    - IP层协议的攻击
    - TCP协议的攻击
    - UDP协议的攻击
    - 应用层协议的攻击

- DDoS攻击原理

  - 大量第三方pc辅助攻击

- DoS/DDoS攻击利用的网络

- 防御措施：防火墙

  - 静态和动态DDoS过滤器
  - 反欺骗技术
  - 异常识别
  - 协议分析
  - 速率限制



#### 4.2.7web脚本攻击

- 注入攻击
- 跨站脚本攻击xss
- 跨站点请求伪造csrf



#### 4.2.8远程控制

- 木马
- webshell：远程控制网站服务器



### 4.3网络安全防护技术

#### 4.3.1防火墙

- 防火墙的概念
  - 置于可信与不可信网络之间
  - 过滤和阻断
- 功能：
  - 内外网之间的数据过滤
  - 网络传输和访问的数据进行记录和审计
  - 防范内外网之间的异常网络攻击
  - 通过配置NAT提高网络地址转换功能    
- 分类：
  - 包过滤技术
  - 状态检测技术
  - 地址翻译技术：
    - 网络地址翻译技术（NAT）
    - 内网IP翻译成合法的公网IP
    - 静态NAT，NAT池（动态池），端口地址转化PAT（端口地址转化）
  - 应用级网关技术
    - 代理服务器
    - 为内网客户提供HTTP，FTP服务
- 体系结构
  - 双宿主主机体系结构
  - 屏蔽主机体系结构
  - 屏蔽子网体系结构
- 防火墙安全策略
  - DZM：缓冲区，堡垒主机对外开放
- 防火墙的配置
- 不能防范
  - 内网间攻击
  - 绕过
  - 病毒和内部驱动的木马

#### 4.3.2入侵检测系统

- 概念：
  - 网络系统关键节点
  - 实时收集信息分析
- 功能：
  - 检测和记录os或network中存在的活动和数据
  - 检测攻击前的探测行为，网络异常行为预警
  - 检测入侵行为提供警告和响应
  - 提供攻击信息

- 分类
  - 按数据采集方式分类：
    - 基于网络的入侵检测系统
    - 基于主机的入侵检测系统
  - 按照检测原理分类：
    - 误用检测
    - 异常检测
- 入侵检测技术
  - 误用检测
    - 专家系统
    - 模型推理
    - 状态转换分析
  - 异常检测
    - 统计分析
    - 神经网络
- 体系结构
  - 基于网络/基于主机
  - 集中式结构
  - 分布式结构
- 入侵防御系统
  - 拦截恶意流量
  - 传输内容的深度检测和安全防护
  - 网络流量监测同时过滤

#### 4.3.3PKI

- 组成

  - 安全策略
  - 证书认证机构
  - 证书注册机构
  - 证书分发系统
  - 基于PKI的应用接口

- 数字证书

  - 用户身份标识的唯一性

  - 基于数字证书的信任链传递关系

    - 数字证书用于相信用户的真实性是通过信任链传递关系保证

  - 基于数字证书的安全机制

    - X.509

      结构

    |     证书的版本号     |
    | :------------------: |
    |     证书的序列号     |
    |       签名算法       |
    |    证书签发机构名    |
    |      证书有效期      |
    |   证书持有者用户名   |
    |   证书用户公钥信息   |
    |   签发者唯一标识符   |
    | 证书持有者唯一标识符 |
    |        签名值        |


#### 4.3.4VPN

- 虚拟专用网
- 加密传输
- 连接类型
  - Client—LAN：远程访问型
  - LAN—LAN：网络到网关，不同局域网之间的连接

#### 4.3.5网络安全协议

- 网络层安全协议IPsec
- 传输层SSL
- 应用层：
  - Kerberos协议
  - SSH
  - SHTTP：安全超文本传输协议
  - S/MIME：安全多用途网际邮件扩充协议
  - SET：安全电子交易协议

