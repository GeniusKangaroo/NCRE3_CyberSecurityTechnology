# 信息安全技术

## 第二章 信息安全技术与原理

### 2.1密码技术

#### 2.1.1对称密码与非对称密码

- 密码的组成（五部分）
  1. 消息空间：明文m
  2. 密文空间：密文c
  3. 密钥空间：密钥k构成的有限集
  4. 加密算法：E   c=E
  5. 解密算法：D  m=D
  
- 对称密钥

  - Ke=Kd

  - 基本元素：明文 加密算法 解密算法 密钥 密文 攻击者
  - 设计原则：在算法公开的条件下保证密钥安全（加解密算法公开，密钥私人保管）
  - 密钥需要在安全信道传输
  - 优点：加解密处理速度快
  - 缺点：
    - 密钥管理和分发复杂、代价高
    - 不能提供抗抵赖服务
  - 分类：
    - 分组密码：明文消息划分多组，每组分别在密钥的控制下转换成<u>等长度</u>输出（DES、AES、IDEA）
    - 序列密码：每一字符对应的密钥进行加密（RC4）
  - 设计思想：扩散/混淆

- 传统的加密方法：

  - 代换法：单表/多表
  - 置换法：栅栏

- 安全性

  - 攻击方法：穷举攻击法、密码分析学

- 非对称密钥
  - Ke≠Kd
  - 通常依赖于某个难解的数学题目（RSA 椭圆曲线）
- 国密算法
  - 分组密码算法—SM4
  - 公钥密码算法—SM2



#### 2.1.2哈希函数

- 性质

  - 单向密码体制
  - 特点：
    - 压缩
    - 易计算
    - 单向性
    - 抗碰撞性
    - 高灵敏性

- 应用

  - 消息认证
  - 数字签名
  - 口令的安全性
  - 数据的完整性（校验算法）

- 消息摘要MD5

  对任意长度的明文生成长度为<u>128</u>位的消息摘要

- SHA

  主要的消息摘要算法



#### 2.1.3数字签名

- 概念

  - 不可抵赖
  - 他人不能伪造
  - 签名判断真伪

- 应用

  - 鉴权

  - 完整性

  - 不可抵赖性

    

#### 2.1.4密钥管理

- 密钥的种类

  - 基本/初始密钥
  - 会话密钥
  - 密钥加密密钥
  - 主机主密钥

- 密钥的生成方法

  - 主密钥：长期保持不变，用于生成其他密钥，任意随机方式生成
  - 加密密钥：机器自动生成
  - 会话密钥：某加密算法动态产生

- 密钥的分发

  - 密钥分发中心（KDC）

  - 密钥转换中心（KTC）




### 2.2认证技术

- 网络攻击的形式：泄密，传输分析，伪装，内容修改，顺序修改，计时修改，发送方否认，接收方否认

#### 2.2.1消息认证

- 验证消息来自发送方且未被篡改
- 功能：
  - 下层：产生认证码的函数（认证码：认证消息的值）
  - 上层：函数作为原语，接收方用于验证消息的真实性
- 认证码的函数类型
  - 消息加密：密文作为认证码
  - 消息认证码：利用密钥生成一个定长度的数据块，附在消息之后
  - 哈希函数：根据消息m生成可变大小的哈希值



#### 2.2.2身份认证

- 认证、授权、审计

- 认证手段：

  - 静态密码
  - 动态口令
    - 短信密码
    - 动态口令牌
  - USB Key
  - 生物识别

- 认证协议

  - 基于口令的认证协议

    问题：

    - 攻击者可以从口令表中获取用户口令
    - 传输路线上截获口令
    - 用户和系统的地位不平等：用户无法验证系统身份

    解决：

    - 单向函数加密口令
    - 一次性口令（动态口令认证手段）

  - 基于对称密码的认证

  - 基于公钥密码的认证



### 2.3访问控制技术

#### 2.3.1访问控制模型

- 分类：

  - 自主访问控制
  - 强制访问控制
  - 计算机安全程度分级（高到低）：A1、B3、B2、B1、C2、C1、D
    - C级：拥有自主型访问控制
    - B级：拥有强制型的访问控制手段

- 自主访问控制

  - 访问控制矩阵

    |        |     目标X      |     目标Y      |     目标Z      |
    | :----: | :------------: | :------------: | :------------: |
    | 用户A  | 读、修改、管理 |                | 读、修改、管理 |
    | 用户B  |                | 读、修改、管理 |                |
    | 用户C1 |       读       |    读、修改    |                |
    | 用户C2 |       读       |    读、修改    |                |

    自主访问控制中，可以将自己的访问权限授权给其他用户

  - 访问能力表和访问控制表

    - 矩阵表空元素浪费存储空间
    - 访问能力表：基于矩阵的行
    - 访问控制表：基于矩阵的列
    - 优点：灵活访问
    - 缺点：信息在传递的过程中访问权限关系会被改变

- 强访问控制（MAC）

  - 安全标签

    | 用户 | 安全级别 |
    | :--: | :------: |
    |  A   |    S     |
    |  B   |    C     |
    |  ……  |  ......  |
    |  X   |    TS    |

    |  文件  | 安全级别 |
    | :----: | :------: |
    |   1    |    S     |
    |   2    |    TS    |
    | ...... |  ......  |
    |   N    |    C     |

    

  - 强访问控制策略

    1. 向下读RD
    2. 向上读RU
    3. 向下写WD
    4. 向上写WU

  - BLP模型

    - 上不读下不写

    - 安全级：无密、秘密、机密、绝密
    - 问题：不保护信息的完整性和可用性，不涉及访问控制

  - Biba模型

    - 不下读不上写
    - 保护信息的完整性
    - 分级：重要，很重要，极重要

  - Chinese Wall

- 基于角色的访问控制模型（RBAC）

  - 要素：
    - 用户：
    - 角色：系统管理员分配
    - 许可
  - 区别：无法像强访问控制模型一样由用户自主授权其他用户



#### 2.3.2访问控制技术

- 集中访问控制

  - 远程用户访问网络资源的AAA过程（认证，授权，审计）

    1. 向网络接入服务器（NAS）发送自己的uid和pwd
    2. NAS将信息转发给验证服务器
    3. 通过验证后，将可用的网络连接参数，授权，协议信息发送给NAS
    4. NAS确认，提供服务，连接写入验证服务器log

  - 拨号用户远程认证服务（RADIUS）

    - 对需要访问的用户或设备进行身份验证

    - 对通过验证的授予访问资源的权限

    - 对已经授权的访问进行审计

    - 过程：

      RADIUS访问—请求(客户端—>服务端）

      RADIUS访问—接受/拒绝/挑战(客户端<—服务端）

    - 特点：简单明确，可扩充

  - 终端访问控制器访问控制系统（TACACS）

    允许远程访问服务器传送用户登录

  - Diameter协议

    采用TCP协议，支持分布式审计

    - 层次结构
      1. 基础协议
      2. NAS协议（网络接入服务）
      3. EAP协议（可扩展鉴别协议）：框架，容纳各种鉴别信息
      4. CMS协议（密码消息语法）：协议数据的端到端加密
      5. MIP协议（Mobile IP）：移动通讯方向

  - Diameter协议与RADIUS协议的区别

    1. 模式：Diameter采用了端对端的模式，任意端都可审计，中断访问
    2. 传输机制：Diameter运行于TCP，SCTP上
    3. 失败恢复机制：RADIUS不支持而Diameter应用层确认
    4. 服务器初始化消息：服务器可以跟随主动需要发起重认证
    5. 认证和授权：RADIUS成对出现而Diameter认证授权分离
    6. 安全机制：RADIUS应用层定义而Diameter必须支持IPsec保证数据的机密性和完整性

- 非集中访问控制

  - 单点登录
  - Kerberos协议：
    - 单点登录
    - 与授权机制相结合
    - 支持双向的身份认证
    - 交换跨域密钥实现分布式网络环境下的认证

#### 

### 2.4审计和监控技术

#### 2.4.1审计和监控基础

- 安全审计的目标：
  1. 必须提供足够的信息
  2. 优化审计的记录内容

- 日志记录器

  便于分析内容

  安全审计的记录机制

- 分析器

  日志作为输入，分析日志数据

  1. 潜在危害分析
  2. 异常检测
  3. 简单攻击探测
  4. 复杂攻击探测

- 通告器

  响应结果



#### 2.4.2审计和监控技术

- 恶意行为监控
  - 被动监听流量
  - 蜜网，蜜罐
- 网络信息内容审计
  - 机密性，真实性，可用性
  - 网络舆情分析
  - 审计系统模型
- 不良信息内容监控方法
  - 网络过滤技术
  - 网络内容过滤技术
  - 图像内容过滤

## 第三章 系统安全

### 3.1操作系统安全

#### 3.1.1操作系统安全基础

- 计算机组成

  |         应用程序         |
  | :----------------------: |
  |        操作系统OS        |
  | 基本输入输出系统（BIOS） |
  |       底层硬件设备       |

  

- OS基本元素
  - 内核模式和用户模式
  - 内存管理
  - 用户接口：
    - 用户与计算机之间的联系
    - 一般设备的系统输入输出
    - 磁盘的输入输出
    - 磁盘文件管理的系统调用
  - 系统调用：子程序提供给应用程序调用

- 操作系统功能
  - 进程管理：多任务实现，多线程高并发  依据进程的优先级和等待顺序分配CPU时间片
  - 文件系统管理
- 基本安全实现机制
  - CPU模式和保护环
    - 保护环对工作在环内的进程权限划定严格的界限
    - 四环保护环：
      1. 0环：OS内核
      2. 1环：操作系统的其他部分
      3. 2环：I/O驱动程序和实用工具
      4. 3环：应用程序和用户活动
  - 进程隔离：
    - 系统对同时执行的进程进行隔离，防止相互影响
    - 不同进程拥有不同虚拟地址

#### 3.1.2操作系统安全实践

- UNIX/Linux系统安全概述

  - UNIX系统架构：
    - 硬件层
    - 内核层
    - 用户层
  - 系统启动过程：
    1. 加载BIOS：Intel CPU实模式自检，执行物理地址为0xFFFF0处的代码，加载BIOS信息
    2. 读取主引导记录：硬盘第0磁道第一扇区成为MBR（主引导记录）512字节含有预启动信息，分区表信息；BIOS找到此位置后，内容复制到0x7C00—引导程序
    3. 加载引导程序
    4. 加载内核：start_kernel()
    5. 执行init进程：
       - init始终是第一个进程（进程编号始终为1）位于/sbin/init读取/etc/inittab文件，初始化工作
       - inittab用于设定Linux运行等级：0-关机、1-单用户模式、2-无网络支持多用户模式、3-有网络支持多用户模式（标准级）、4-保留、5-有网络支持及X-Window支持的多用户模式、6-重新引导系统
       - /bin/login程序执行，将进入登录状态
  - 系统服务和进程
    - 守护进程
    - 启动与关闭服务：/etc/services；/etc/inetd.conf文件用于启动进程，可以修改脚本的内容
    - inetd进程：UNIX的网络服务进程

- UNIX/Linux系统安全

  - 权限标志：可读（r）、可写（w）、可执行（x）
  - Linux中pwd存放于/etc/passwd文件
  - 通常将口令字段为x，存于/etc/shadow
  - 如果口令为*则该账号被查封了
  - 禁用账号/etc/passwd中用户名前加#
  - 伪用户账号
  - root账户管理

- 日志与审计

  - 日志系统

    1. 记录连接时间的日志
    2. 统计进程
    3. 错误日志

  - 连接时间日志

  - 进程统计日志：基本服务提供命令使用统计

  - 错误日志

  - 四种基本的用户模式进程：

    - 系统支持进程

    - 服务进程

    - 环境子系统

    - 用户应用程序

      

### 3.2数据库安全

#### 3.2.1数据库安全基础

- 数据库概念
  - 信息的集合
  - 数据库管理系统（DBMS）
- 结构化查询语言（SQL）
  - 高级的非过程化编程语言
- 数据库安全概念
  - 可共享，防止数据泄露、更改、破坏
  - 非法使用数据库的情况：
    - 编写合法程序绕过DBMS和授权机制
    - 直接或编写执行程序执行非授权操作
    - 多次合法查询数据库，推导出保密数据
- 数据库安全功能
  - 用户标识和鉴定
  - 存取控制
  - 审计：用户级审计/系统级别审计
  - 数据加密
- 数据的完整性
  - 约束
  - 默认值
  - 规则
  - 事务处理
    - 术语：
      1. 事务：指一组SQL语句
      2. 回退：撤销SQL语句的过程
      3. 提交：未存储的SQL语句写入数据库表
      4. 保留点：事务处理中的临时占位符，可以对他发布回退
    - 事务处理的特征：
      1. 原子性：事务是处理的一个原子单位，要么全部执行要么全部不执行
      2. 一致性
      3. 隔离性
      4. 持久性
    - 类型：
      1. 自动处理事务
      2. 隐式事务
      3. 用户定义事务：用户控制事物的开始结束
      4. 分布式事务：跨越多服务器

#### 3.2.2数据库安全实践

- 数据库威胁与防护
  - 十大威胁：
    - 过度的特权滥用
    - 合法的特权滥用
    - 特权提升
    - 平台漏洞
    - sql注入
    - 不健全的审计
    - 数据库通信协议漏洞
    - 不健全的认证
    - 备份数据暴露
- 数据库安全特性检查
  - 安全检测：
    1. 端口扫描
    2. 渗透测试
    3. 内部安全检测
- 数据库运行安全监管
- 数据库托敏
  - 个人标识泄露
  - 属性泄露
  - 成员关系泄露
- 脱敏方式：
  - 同义替换
  - 混合屏蔽
  - 确定性屏蔽
  - 可逆脱敏

## 第四章 网络安全

### 4.1网络安全基础

#### 4.1.1 TCP/IP 协议架构

- TCP/IP开放模型
  - 物理和数据链路层
  - 网络层
  - 传输层
  - 应用层
- OSI/RM模型
  - 应用层
  - 表示层
  - 会话层
  - 传输层
  - 网络层
  - 数据链路层
  - 物理层

#### 4.1.2网络协议

- 数据链路层协议

  - ARP协议（地址解析）
    - 通过ip识别数据包发送的源主机和目的主机
    - MAC地址+数据帧
    - 实现ip地址与主机的MAC地址转换
    - ip与MAC之间的映射
    - 地址解析是在一个物理网络内的
  - RARP协议
    - 逆向地址转换协议
    - MAC转为ip

- 网络层协议

  - IP协议：实现跨越不同网络之间的主机通信

    - IP地址：32位的二进制IP地址，每8个一组转化为十进制数

      ​               前半部分为网络号，后半部分为主机号

    - IP地址分类：

      |          类别           |            IP             | 开头 | 网络号长度 | 主机号长度 |  含有主机个数  |
      | :---------------------: | :-----------------------: | :--: | :--------: | :--------: | :------------: |
      |            A            |  0.0.0.0~127.255.255.255  |  0   |     7      |     24     |  2的24次方-2   |
      | B（2的14次方个B类网络） | 128.0.0.0~191.255.255.255 |  10  |     14     |     16     |  2的16次方-2   |
      | C（2的21次方个C类网络） | 192.0.0.0~233.255.255.255 | 110  |     21     |     8      | 2的8次方-2/254 |
      |            D            | 234.0.0.0~239.255.255.255 | 1110 |     /      |     /      |       /        |
      |            E            | 240.0.0.0~255.255.255.255 | 1111 |     /      |     /      |       /        |

    - 其他IP地址：

      对于内网的网络设定，私有IP地址

      1. A类：10.0.0.0~10.255.255.255
      2. B类：172.16.0.0~172.31.255.255
      3. C类：192.168.0.0~192.168.255.255

    - IP数据包格式
    
    <img src="https://raw.githubusercontent.com/GeniusKangaroo/NCRE3_CyberSecurityTechnology/main/e56b9113abd9c2fe9ce83ff0c814734.jpg" style="zoom: 25%;" />
    
    
    
  - ICMP协议
  
    - 网络异常状态的监听和检测
    - TCP/IP网络中发送出错和控制消息
    - 错误侦测和反馈机制
  
- 传输层协议

  - TCP协议：

    - 头部格式：
      - tcp数据包由头部和数据两部分组成
      - 头部前20字节是固定的后面均可变
    - 三次握手：
      1. 源主机—>目标主机发送ACK为1的应答包，数据包中设置了源和目标的IP和port；SEQ=X
      2. 目标主机自动应答，返回数据包，表示同意建立链接；ACK=1，SYN=1，SEQ=Y，确认号=X+1
      3. 源主机—>目标主机发送ACK为1的应答包，确认建立链接；SEQ=X，确认号=Y+1

  - UDP协议：

    - 无连接的传输协议

- 应用层协议

  - HTTP：
    - 超文本传输协议
    - port：80
    - 先建立TCP连接
    - GET/POST提交数据
  - SMTP&POP3：
    - 简单邮件传输协议
    - port：25
    - 基于TCP协议
    - pop3是应用最广泛的邮件访问协议
  
- DNS：域名解析



### 4.2网络安全威胁技术

#### 4.2.1扫描技术
